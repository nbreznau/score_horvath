"0","df_orig <- df_origa %>%"
"0","  mutate(stdliv_past5 = car::recode(v272, ""8 = 3""), # don't knows were recoded into middle cat in original study"
"0","         stdliv_past5_di = car::recode(stdliv_past5, ""c(1,2) = 1; c(4,5) = 2; c(3) = 3""),"
"0","         stdliv_next5 = car::recode(v273, ""8 = 3""),"
"0","         stdliv_next5_di = car::recode(stdliv_next5, ""c(1,2) = 1; c(4,5) = 2; c(3) = 3""),"
"0","         noway_future_improve = as.numeric(as.character(ifelse(v276 == ""no any way"", 1, 0))),"
"0","         mkt_econ_eval = car::recode(v4, ""'dont know' = 3""),"
"0","         mkt_econ_eval_di = car::recode(mkt_econ_eval, ""c('very positively','positively') = 1; c('negatively','very negatively') = 2; c('neither positively nor negatively') = 3""),"
"0","         student = ifelse(v200 == 2 | v200 == 9, NA, 0), # remove students and NA's"
"0","         wave = as.numeric(car::recode(year, ""c('1993','1994','1995','1996') = '1993'; c('2007') = '2007'; c('1997','1998','2001','2002','2003','2004','2005','2006') = NA"")),"
"0","         female = as.numeric(v298) - 1,"
"0","         pensions = ifelse(is.na(v270), NA, ifelse(v270==2, 1, 0)),"
"0","         unemployed = ifelse(v200 == 8, NA, ifelse(v200==4, 1, 0)),"
"0","         car_owner = ifelse(v262 ==1, 1, 0),"
"0","         education = car::recode(std_education, ""c(0,1,2) = 1; c(3,4) = 2; c(5,6) = 3; c(99) = NA""), # some had 99 in the std_education variable still, made into primary"
"0","         education_a = car::recode(std_education, ""c(1,2,95,96) = 1; c(3,4,5,6,8) = 2; c(7,9,10,11,12) = 3; c(98,99,14) = NA""), # 4 and 5 are questionable categories here"
"0","         education = ifelse(cntry == ""russia"" & year == 1996, education_a, education),"
"0","         # There is a problem with Russia in 1996, seems that it was not recoded into ISCED"
"0","         EGP6 = car::recode(rclass10, ""'Missing in 93-03 data' = 8;'semi-unskilld manual' = 5; 'skilled manual' = 4; 'higher controllers' = 1;'lo controllers' = 1;  'routine nonmanual'= 2; 'sempl without empl' = 3; 'sempl with emp' = 4; 'selfempl farm' = 6; 'farm labor'=6; 'manual supervisor' = 4; 'Missing Occupation Code 07' = 8; 'Not ISKO codes' = 8; 'ISKO Coded - no match' = 8; 'Never had a paying job' = 7""),"
"0","         EGP6 = ifelse(EGP6 == 8 & r2class10 == ""never had a paying job"", ""7"", EGP6),"
"0","         EGP6 = ifelse(is.na(v201), EGP6, ifelse(v201 == ""no"", ""7"", EGP6)), # never had a paid job"
"0","         EGP6 = ifelse(EGP6 == 8, NA, EGP6)"
"0","         ) %>%"
"0","  group_by(cntry, year) %>%"
"0","  mutate(income = ifelse(is.na(v269), 4, ntile(v269, 3))) %>%"
"0","  ungroup()"
"0",""
"0",""
"0",""
"0",""
"0","# some weights are NA, replace with 1 (actually there are no weights for 1993, so this is not really helpful)"
"0","df_orig$weight <- ifelse(is.na(df_orig$v461), 1, df_orig$v461)"
"0",""
"0","# create complete cases df"
"0","df_orig_complete <- df_orig[!is.na(df_orig[""education""]),]"
"0","# df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""income""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""EGP6""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""female""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""wave""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""student""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""pensions""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""unemployed""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""car_owner""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""stdliv_past5""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""stdliv_next5""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""mkt_econ_eval""]),]"
"0","df_orig_complete <- df_orig_complete[!is.na(df_orig_complete[""noway_future_improve""]),]"
"0","# create factor dummies"
"0","df_orig_complete <- dummy_cols(df_orig_complete, select_columns = c(""EGP6"", ""income"", ""education"",""stdliv_past5_di"",""stdliv_next5_di"",""mkt_econ_eval_di""))"
"0",""
"0","#create new group ID"
"0","df_orig_complete$group <- df_orig_complete$cat_age + (100*df_orig_complete$wave)"
"0",""
"0","# cases per group"
"0",""
"0","cases <- df_orig_complete %>%"
"0","  group_by(group) %>%"
"0","  count() %>%"
"0","  ungroup() %>%"
"0","  dplyr::select(-group) %>%"
"0","  t()"
"0",""
"0","  #df_orig <- select(df_orig, v201, rclass10, EGP6, everything())"
